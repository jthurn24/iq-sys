@model IQI.Intuition.Web.Models.Reporting.Infection.Facility.QuarterlyInfectionByWingView

@{
    ViewBag.QuickListAction = "FacilityReportQuickList";
    ViewBag.QuickListItem = "Quarterly Infections By Wing";
    ViewBag.IsExportable = true;
}

<section class="grid_16 box leading"> 
        <h3>Quarterly Infection Control Report</h3>
        <div class="inside">
        @using (Html.BeginForm(null, null, FormMethod.Get))
        {
            <div style="padding:10px;">
            @Html.DropDownListFor(m => m.Quarter, Model.QuarterOptions)                                                 
            @Html.SmartSubmit("Refresh")
            </div> 
        }
        </div> 
        <div style="font-weight:bold;font-size:12px;text-align:center;padding-top:5px;padding-bottom:5px;">Data Last Updated: @ViewContext.LastSynchronized() </div>
</section>

@foreach (var group in Model.Groups)
{
 <section class="grid_16 box leading"> 
        <h3>@group.Description</h3>
        <div class="inside">
        <br />
        <table class="iqitable">
            <tr>
                <th>&nbsp;</th>
                <th colspan="3">@Model.Month1.Name</th>
                <th colspan="3">@Model.Month2.Name</th>
                <th colspan="3">@Model.Month3.Name</th>
            </tr>
            <tr>
                <th>Type</th>
                <th>Inf#</th>
                <th>Inf/1000 PD</th>
                <th>Change</th>
                <th>Inf#</th>
                <th>Inf/1000 PD</th>
                <th>Change</th>
                <th>Inf#</th>
                <th>Inf/1000 PD</th>
                <th>Change</th>
            </tr>
            @foreach (var detail in group.Details)
            {

                var styleAttribute = string.Empty;
                if (detail.IsSubCategory)
                {
                    styleAttribute = "background-color:#d5e0be;font-weight:bold;";
                }

                <tr @Html.Raw(styleAttribute) >
                    <td style="border-right:1px solid black;@Html.Raw(styleAttribute)" >@detail.Description</td>  
                    <td style="font-weight:bold;@Html.Raw(styleAttribute)">@Html.RenderAnnotation(detail.Month1Total,detail.Month1Total.Total)</td>    
                    <td style="@Html.Raw(styleAttribute)" >@detail.Month1Total.Rate.ToString("#0.00")</td>  
                    <td style="@Html.Raw(styleAttribute)" >
                        <div style="width:40px;text-align:right;">
                        @detail.Month1Total.Change.ToString("#0.00")

                        @if (detail.Month1Total.Change > 0)
                        {
                            <img src="@Url.Content("~/Content/images/up.png")" />
                        }
                        else if (detail.Month1Total.Change < 0)
                        {
                            <img src="@Url.Content("~/Content/images/down.png")" />
                        }
                        else
                        {
                            <img src="@Url.Content("~/Content/images/nochange.png")" />
                        }
                        </div>
                    </td>    
                    <td style="font-weight:bold;@Html.Raw(styleAttribute)">@Html.RenderAnnotation(detail.Month2Total,detail.Month2Total.Total)</td>      
                    <td style="@Html.Raw(styleAttribute)" >@detail.Month2Total.Rate.ToString("#0.00")</td>  
                    <td style="@Html.Raw(styleAttribute)" >
                        <div style="width:40px;text-align:right;">
                        @detail.Month2Total.Change.ToString("#0.00")

                        @if (detail.Month2Total.Change > 0)
                        {
                            <img src="@Url.Content("~/Content/images/up.png")" />
                        }
                        else if (detail.Month2Total.Change < 0)
                        {
                            <img src="@Url.Content("~/Content/images/down.png")" />
                        }
                        else
                        {
                            <img src="@Url.Content("~/Content/images/nochange.png")" />
                        }
                        </div>
                    </td>
                    <td style="font-weight:bold;@Html.Raw(styleAttribute)">@Html.RenderAnnotation(detail.Month3Total,detail.Month3Total.Total)</td>     
                    <td style="@Html.Raw(styleAttribute)" >@detail.Month3Total.Rate.ToString("#0.00")</td>  
                    <td style="@Html.Raw(styleAttribute)" >
                        <div style="width:40px;text-align:right;">
                        @detail.Month3Total.Change.ToString("#0.00")

                        @if (detail.Month3Total.Change > 0)
                        {
                            <img src="@Url.Content("~/Content/images/up.png")" />
                        }
                        else if (detail.Month3Total.Change < 0)
                        {
                            <img src="@Url.Content("~/Content/images/down.png")" />
                        }
                        else
                        {
                            <img src="@Url.Content("~/Content/images/nochange.png")" />
                        }
                        </div>
                    </td>        
                </tr>
            }
            </table>
    </div>
</section>   
}




<section class="grid_8 box leading"> 
        <h3>@Model.Month1.Name</h3>
        <div class="inside">
        @Html.DisplayFor(m => m.Month1Chart)
        </div> 
</section>

<section class="grid_8 box leading"> 
        <h3>@Model.Month2.Name</h3>
        <div class="inside">
        @Html.DisplayFor(m => m.Month2Chart)
        </div> 
</section>

<div style="clear:both"></div>

<section class="grid_8 box leading"> 
        <h3>@Model.Month3.Name</h3>
        <div class="inside">
        @Html.DisplayFor(m => m.Month3Chart)
        </div> 
</section>

<section class="grid_8 box leading"> 
        <h3>Totals</h3>
        <div class="inside">
        @Html.DisplayFor(m => m.TotalChart)
        </div> 
</section>

<div class="clear"></div>